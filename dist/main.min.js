(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/entities/player.js":[function(require,module,exports){
var Player = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'testsprite');
    game.add.existing(this);
}

Player.prototype = Object.create(Phaser.Sprite.prototype);
Player.prototype.constructor = Player;

/**
 * Automatically called by World.update
 */
Player.prototype.update = function() {
};

module.exports = Player;

},{}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 600, Phaser.AUTO, 'pixelcrawl-game');

window.Utils = require('./utils');
window.playerState = {
    currentLevel: 'Game'
}

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');


},{"./states/boot":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/boot.js","./states/game":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/game.js","./states/menu":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/menu.js","./states/preloader":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/preloader.js","./states/splash":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/splash.js","./utils":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/utils.js"}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth =  800;
      this.game.scale.minHeight = 600;
      this.game.scale.maxWidth =1024;
      this.game.scale.maxHeight = 1024;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

},{}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/game.js":[function(require,module,exports){
var Player = require('../entities/player');
var Walk = require('../util/walk');

var Game = function () {
  this.testentity = null;
};

module.exports = Game;

Game.prototype = {
  create: function () {
    this.game.stage.backgroundColor = 0x444444;
    this.game.physics.startSystem(Phaser.Physics.arcade);
    var x = (this.game.width / 2) - 100;
    var y = (this.game.height / 2) - 50;
    this.map = this.game.add.tilemap();
    //(tileset, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)
    this.map.addTilesetImage('crawl_tileset');
    this.layer1 = this.map.create('level1', 200, 200, 32, 32);
    this.layer1.resizeWorld();
    this.map.fill(809, 0, 0, 200, 200, this.layer1);
    this.map.fill(0, 10, 10, 5, 8, this.layer1);
    this.player = this.game.add.sprite(11*32, 11*32, 'player');

    this.game.physics.arcade.enable(this.layer1);
    this.game.physics.arcade.enable(this.player);

    this.map.setCollision(809);
    //Then the physics engine creates collision bodies from the tiles:

    //the camera will follow the player in the world
    this.game.camera.follow(this.player);
    this.player.body.setSize(32, 32, 0, 0);
    //move player with cursor keys
    this.cursors = this.game.input.keyboard.createCursorKeys();


    //this.testentity = new Player(this.game, x, y);
    this.something = new Walk();
    //this.walkData = this.something.drunkardWalk([0,0],100,true);
    //this.testentity.anchor.setTo(0.5, 0.5);

    //this.outlineRoom(this.map,5,5,5,10);

    this.input.onDown.add(this.onInputDown, this);

  },

  update: function () {
    this.game.physics.arcade.collide(this.player, this.layer1);
    //player movement
    this.player.body.velocity.y = 0;
    this.player.body.velocity.x = 0;

    if(this.cursors.up.isDown) {
      this.player.body.velocity.y -= 320;
    }
    else if(this.cursors.down.isDown) {
      this.player.body.velocity.y += 320;
    }
    if(this.cursors.left.isDown) {
      this.player.body.velocity.x -= 320;
    }
    else if(this.cursors.right.isDown) {
      this.player.body.velocity.x += 320;
    }
  },

  onInputDown: function () {
    this.game.state.start('Menu');
  }
};

},{"../entities/player":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/entities/player.js","../util/walk":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/util/walk.js"}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    var style = { font: "65px Arial", fill: "#ffffff", align: "center" };

    this.text = this.add.text(x - 300, y - 200, "Press to Start", style);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    this.game.state.start(playerState.currentLevel);
  }
};

},{}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('testsprite', 'assets/test.png');
    this.load.image('rougelite','assets/tileset/tile.png');
    this.load.image('crawl_tileset','assets/tileset/crawl_tileset.png');
    this.load.image('player','assets/player.png');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      this.game.state.start('Menu');
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/states/splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/util/random.js":[function(require,module,exports){
/**
 * Returns a random number between min (inclusive) and max (exclusive)
 */
module.exports.getRandomArbitrary = function getRandomArbitrary(min, max) {
  return Math.random() * (max - min) + min;
};

/**
 * Returns a random integer between min (inclusive) and max (inclusive)
 * Using Math.round() will give you a non-uniform distribution!
 */
module.exports.getRandomInt = function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
};
/**
 * Shuffle an array randomly
 * @param array
 * @returns {*}
 */
module.exports.shuffleArray = function shuffleArray(array) {
  for (var i = array.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    var temp = array[i];
    array[i] = array[j];
    array[j] = temp;
  }
  return array;
};

},{}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/util/walk.js":[function(require,module,exports){
var random = require('../util/random');

var Walk = function() {
  var something;
};

Walk.prototype.randomWalk = function randomWalk(steps, cardinal) {
  var path = [];
  for (var i = 0; i < steps; i++) {
    path.push(this.randomDirection(cardinal))
  }
  return path;
};

Walk.prototype.drunkardWalk = function drunkardWalk(start, steps, cardinal) {
  var path = [];
  var currentStep = start;
  var nextStep;
  var possibleSteps = this.possibleSteps(cardinal);

  //Loop for n steps
  while (steps > 0) {
    //Get a random shuffled array of all possible steps
    var nextStepList = random.shuffleArray(possibleSteps).slice();
    //Attempt each step in array
    while (nextStepList.length > 0) {
      nextStep = nextStepList.pop();
      var attemptedStep = [currentStep[0] + nextStep[0], currentStep[1] + nextStep[1]];
      //if step has not been taken then take the step
      if (!this.stepInPath(attemptedStep, path)) {
        break;
      }
    }
    //No more steps possible
    if (nextStepList.length == 0) {
      break;
    }
    else {
      currentStep = [currentStep[0] + nextStep[0], currentStep[1] + nextStep[1]];
      console.log(currentStep);
      path.push(currentStep);
      steps--;
    }
  }
  return path;
};
Walk.prototype.stepInPath = function stepInPath(step, path) {
  for (var i = 0; i < path.length; i++) {
    if (step[0] == path[i][0] && step[1] == path[1]) {
      return true;
    }
  }
  return false;
};
Walk.prototype.possibleSteps = function possibleSteps(cardinal) {
  if (cardinal) {
    return [[0, 1], [1, 0], [0, -1], [-1, 0]];
  }
  else {
    return [[0, 1], [1, 1], [1, 0], [1, -1], [0, -1], [-1, -1], [-1, 0], [-1, 1]];
  }
};
Walk.prototype.randomDirection = function randomDirection(cardinal) {
  var direction = 0;
  if (cardinal) {
    direction = random.getRandomInt(0, 3);
    switch (direction) {
      case 0:
        return [0, 1];
      case 1:
        return [1, 0];
      case 2:
        return [0, -1];
      case 3:
        return [-1, 0];
    }
  }
  else {
    direction = random.getRandomInt(0, 7);
    switch (direction) {
      case 0:
        return [0, 1];
      case 1:
        return [1, 1];
      case 2:
        return [1, 0];
      case 3:
        return [1, -1];
      case 4:
        return [0, -1];
      case 5:
        return [-1, -1];
      case 6:
        return [-1, 0];
      case 7:
        return [-1, 1];
    }
  }
};
module.exports = Walk;
},{"../util/random":"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/util/random.js"}],"/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/utils.js":[function(require,module,exports){
var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    }
};

module.exports = Utils;
},{}]},{},["/Users/ianlintner/Documents/Projects/pixelcrawl/src/js/main.js"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZW50aXRpZXMvcGxheWVyLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy9zdGF0ZXMvc3BsYXNoLmpzIiwic3JjL2pzL3V0aWwvcmFuZG9tLmpzIiwic3JjL2pzL3V0aWwvd2Fsay5qcyIsInNyYy9qcy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgUGxheWVyID0gZnVuY3Rpb24gKGdhbWUsIHgsIHkpIHtcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgJ3Rlc3RzcHJpdGUnKTtcbiAgICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcbn1cblxuUGxheWVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xuUGxheWVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFBsYXllcjtcblxuLyoqXG4gKiBBdXRvbWF0aWNhbGx5IGNhbGxlZCBieSBXb3JsZC51cGRhdGVcbiAqL1xuUGxheWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUGxheWVyO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg4MDAsIDYwMCwgUGhhc2VyLkFVVE8sICdwaXhlbGNyYXdsLWdhbWUnKTtcblxud2luZG93LlV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xud2luZG93LnBsYXllclN0YXRlID0ge1xuICAgIGN1cnJlbnRMZXZlbDogJ0dhbWUnXG59XG5cbmdhbWUuc3RhdGUuYWRkKCdCb290JywgcmVxdWlyZSgnLi9zdGF0ZXMvYm9vdCcpKTtcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XG5nYW1lLnN0YXRlLmFkZCgnUHJlbG9hZGVyJywgcmVxdWlyZSgnLi9zdGF0ZXMvcHJlbG9hZGVyJykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ01lbnUnLCByZXF1aXJlKCcuL3N0YXRlcy9tZW51JykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ0dhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9nYW1lJykpO1xuXG5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7XG5cbiIsInZhciBCb290ID0gZnVuY3Rpb24gKCkge307XG5cbm1vZHVsZS5leHBvcnRzID0gQm9vdDtcblxuQm9vdC5wcm90b3R5cGUgPSB7XG5cbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubG9hZC5pbWFnZSgncHJlbG9hZGVyJywgJ2Fzc2V0cy9wcmVsb2FkZXIuZ2lmJyk7XG4gIH0sXG5cbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5nYW1lLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcblxuICAgIGlmICh0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApIHtcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2NhbGVNb2RlID0gUGhhc2VyLlNjYWxlTWFuYWdlci5TSE9XX0FMTDtcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5taW5XaWR0aCA9ICA4MDA7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluSGVpZ2h0ID0gNjAwO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heFdpZHRoID0xMDI0O1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heEhlaWdodCA9IDEwMjQ7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuZm9yY2VMYW5kc2NhcGUgPSB0cnVlO1xuICAgICAgdGhpcy5nYW1lLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2V0U2NyZWVuU2l6ZSh0cnVlKTtcbiAgICB9XG5cbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ1ByZWxvYWRlcicpO1xuICB9XG59O1xuIiwidmFyIFBsYXllciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL3BsYXllcicpO1xudmFyIFdhbGsgPSByZXF1aXJlKCcuLi91dGlsL3dhbGsnKTtcblxudmFyIEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMudGVzdGVudGl0eSA9IG51bGw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XG5cbkdhbWUucHJvdG90eXBlID0ge1xuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gMHg0NDQ0NDQ7XG4gICAgdGhpcy5nYW1lLnBoeXNpY3Muc3RhcnRTeXN0ZW0oUGhhc2VyLlBoeXNpY3MuYXJjYWRlKTtcbiAgICB2YXIgeCA9ICh0aGlzLmdhbWUud2lkdGggLyAyKSAtIDEwMDtcbiAgICB2YXIgeSA9ICh0aGlzLmdhbWUuaGVpZ2h0IC8gMikgLSA1MDtcbiAgICB0aGlzLm1hcCA9IHRoaXMuZ2FtZS5hZGQudGlsZW1hcCgpO1xuICAgIC8vKHRpbGVzZXQsIGtleSwgdGlsZVdpZHRoLCB0aWxlSGVpZ2h0LCB0aWxlTWFyZ2luLCB0aWxlU3BhY2luZywgZ2lkKVxuICAgIHRoaXMubWFwLmFkZFRpbGVzZXRJbWFnZSgnY3Jhd2xfdGlsZXNldCcpO1xuICAgIHRoaXMubGF5ZXIxID0gdGhpcy5tYXAuY3JlYXRlKCdsZXZlbDEnLCAyMDAsIDIwMCwgMzIsIDMyKTtcbiAgICB0aGlzLmxheWVyMS5yZXNpemVXb3JsZCgpO1xuICAgIHRoaXMubWFwLmZpbGwoODA5LCAwLCAwLCAyMDAsIDIwMCwgdGhpcy5sYXllcjEpO1xuICAgIHRoaXMubWFwLmZpbGwoMCwgMTAsIDEwLCA1LCA4LCB0aGlzLmxheWVyMSk7XG4gICAgdGhpcy5wbGF5ZXIgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSgxMSozMiwgMTEqMzIsICdwbGF5ZXInKTtcblxuICAgIHRoaXMuZ2FtZS5waHlzaWNzLmFyY2FkZS5lbmFibGUodGhpcy5sYXllcjEpO1xuICAgIHRoaXMuZ2FtZS5waHlzaWNzLmFyY2FkZS5lbmFibGUodGhpcy5wbGF5ZXIpO1xuXG4gICAgdGhpcy5tYXAuc2V0Q29sbGlzaW9uKDgwOSk7XG4gICAgLy9UaGVuIHRoZSBwaHlzaWNzIGVuZ2luZSBjcmVhdGVzIGNvbGxpc2lvbiBib2RpZXMgZnJvbSB0aGUgdGlsZXM6XG5cbiAgICAvL3RoZSBjYW1lcmEgd2lsbCBmb2xsb3cgdGhlIHBsYXllciBpbiB0aGUgd29ybGRcbiAgICB0aGlzLmdhbWUuY2FtZXJhLmZvbGxvdyh0aGlzLnBsYXllcik7XG4gICAgdGhpcy5wbGF5ZXIuYm9keS5zZXRTaXplKDMyLCAzMiwgMCwgMCk7XG4gICAgLy9tb3ZlIHBsYXllciB3aXRoIGN1cnNvciBrZXlzXG4gICAgdGhpcy5jdXJzb3JzID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmNyZWF0ZUN1cnNvcktleXMoKTtcblxuXG4gICAgLy90aGlzLnRlc3RlbnRpdHkgPSBuZXcgUGxheWVyKHRoaXMuZ2FtZSwgeCwgeSk7XG4gICAgdGhpcy5zb21ldGhpbmcgPSBuZXcgV2FsaygpO1xuICAgIC8vdGhpcy53YWxrRGF0YSA9IHRoaXMuc29tZXRoaW5nLmRydW5rYXJkV2FsayhbMCwwXSwxMDAsdHJ1ZSk7XG4gICAgLy90aGlzLnRlc3RlbnRpdHkuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcblxuICAgIC8vdGhpcy5vdXRsaW5lUm9vbSh0aGlzLm1hcCw1LDUsNSwxMCk7XG5cbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbklucHV0RG93biwgdGhpcyk7XG5cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdhbWUucGh5c2ljcy5hcmNhZGUuY29sbGlkZSh0aGlzLnBsYXllciwgdGhpcy5sYXllcjEpO1xuICAgIC8vcGxheWVyIG1vdmVtZW50XG4gICAgdGhpcy5wbGF5ZXIuYm9keS52ZWxvY2l0eS55ID0gMDtcbiAgICB0aGlzLnBsYXllci5ib2R5LnZlbG9jaXR5LnggPSAwO1xuXG4gICAgaWYodGhpcy5jdXJzb3JzLnVwLmlzRG93bikge1xuICAgICAgdGhpcy5wbGF5ZXIuYm9keS52ZWxvY2l0eS55IC09IDMyMDtcbiAgICB9XG4gICAgZWxzZSBpZih0aGlzLmN1cnNvcnMuZG93bi5pc0Rvd24pIHtcbiAgICAgIHRoaXMucGxheWVyLmJvZHkudmVsb2NpdHkueSArPSAzMjA7XG4gICAgfVxuICAgIGlmKHRoaXMuY3Vyc29ycy5sZWZ0LmlzRG93bikge1xuICAgICAgdGhpcy5wbGF5ZXIuYm9keS52ZWxvY2l0eS54IC09IDMyMDtcbiAgICB9XG4gICAgZWxzZSBpZih0aGlzLmN1cnNvcnMucmlnaHQuaXNEb3duKSB7XG4gICAgICB0aGlzLnBsYXllci5ib2R5LnZlbG9jaXR5LnggKz0gMzIwO1xuICAgIH1cbiAgfSxcblxuICBvbklucHV0RG93bjogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xuICB9XG59O1xuIiwidmFyIE1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMudGV4dCA9IG51bGw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1lbnU7XG5cbk1lbnUucHJvdG90eXBlID0ge1xuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHZhciB4ID0gdGhpcy5nYW1lLndpZHRoIC8gMjtcbiAgICB2YXIgeSA9IHRoaXMuZ2FtZS5oZWlnaHQgLyAyO1xuXG4gICAgdmFyIHN0eWxlID0geyBmb250OiBcIjY1cHggQXJpYWxcIiwgZmlsbDogXCIjZmZmZmZmXCIsIGFsaWduOiBcImNlbnRlclwiIH07XG5cbiAgICB0aGlzLnRleHQgPSB0aGlzLmFkZC50ZXh0KHggLSAzMDAsIHkgLSAyMDAsIFwiUHJlc3MgdG8gU3RhcnRcIiwgc3R5bGUpO1xuXG4gICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgfSxcblxuICBvbkRvd246IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQocGxheWVyU3RhdGUuY3VycmVudExldmVsKTtcbiAgfVxufTtcbiIsInZhciBQcmVsb2FkZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xuICB0aGlzLmFzc2V0ID0gbnVsbDtcbiAgdGhpcy5yZWFkeSA9IGZhbHNlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcmVsb2FkZXI7XG5cblByZWxvYWRlci5wcm90b3R5cGUgPSB7XG5cbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYXNzZXQgPSB0aGlzLmFkZC5zcHJpdGUoMzIwLCAyNDAsICdwcmVsb2FkZXInKTtcbiAgICB0aGlzLmFzc2V0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG5cbiAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZSh0aGlzLm9uTG9hZENvbXBsZXRlLCB0aGlzKTtcbiAgICB0aGlzLmxvYWQuc2V0UHJlbG9hZFNwcml0ZSh0aGlzLmFzc2V0KTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3Rlc3RzcHJpdGUnLCAnYXNzZXRzL3Rlc3QucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdyb3VnZWxpdGUnLCdhc3NldHMvdGlsZXNldC90aWxlLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnY3Jhd2xfdGlsZXNldCcsJ2Fzc2V0cy90aWxlc2V0L2NyYXdsX3RpbGVzZXQucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdwbGF5ZXInLCdhc3NldHMvcGxheWVyLnBuZycpO1xuICB9LFxuXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoISF0aGlzLnJlYWR5KSB7XG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcbiAgICB9XG4gIH0sXG5cbiAgb25Mb2FkQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgfVxufTtcbiIsInZhciBTcGxhc2ggPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaDtcblxuU3BsYXNoLnByb3RvdHlwZSA9IHtcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gIH1cbn07IiwiLyoqXG4gKiBSZXR1cm5zIGEgcmFuZG9tIG51bWJlciBiZXR3ZWVuIG1pbiAoaW5jbHVzaXZlKSBhbmQgbWF4IChleGNsdXNpdmUpXG4gKi9cbm1vZHVsZS5leHBvcnRzLmdldFJhbmRvbUFyYml0cmFyeSA9IGZ1bmN0aW9uIGdldFJhbmRvbUFyYml0cmFyeShtaW4sIG1heCkge1xuICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluO1xufTtcblxuLyoqXG4gKiBSZXR1cm5zIGEgcmFuZG9tIGludGVnZXIgYmV0d2VlbiBtaW4gKGluY2x1c2l2ZSkgYW5kIG1heCAoaW5jbHVzaXZlKVxuICogVXNpbmcgTWF0aC5yb3VuZCgpIHdpbGwgZ2l2ZSB5b3UgYSBub24tdW5pZm9ybSBkaXN0cmlidXRpb24hXG4gKi9cbm1vZHVsZS5leHBvcnRzLmdldFJhbmRvbUludCA9IGZ1bmN0aW9uIGdldFJhbmRvbUludChtaW4sIG1heCkge1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcbn07XG4vKipcbiAqIFNodWZmbGUgYW4gYXJyYXkgcmFuZG9tbHlcbiAqIEBwYXJhbSBhcnJheVxuICogQHJldHVybnMgeyp9XG4gKi9cbm1vZHVsZS5leHBvcnRzLnNodWZmbGVBcnJheSA9IGZ1bmN0aW9uIHNodWZmbGVBcnJheShhcnJheSkge1xuICBmb3IgKHZhciBpID0gYXJyYXkubGVuZ3RoIC0gMTsgaSA+IDA7IGktLSkge1xuICAgIHZhciBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGkgKyAxKSk7XG4gICAgdmFyIHRlbXAgPSBhcnJheVtpXTtcbiAgICBhcnJheVtpXSA9IGFycmF5W2pdO1xuICAgIGFycmF5W2pdID0gdGVtcDtcbiAgfVxuICByZXR1cm4gYXJyYXk7XG59O1xuIiwidmFyIHJhbmRvbSA9IHJlcXVpcmUoJy4uL3V0aWwvcmFuZG9tJyk7XG5cbnZhciBXYWxrID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzb21ldGhpbmc7XG59O1xuXG5XYWxrLnByb3RvdHlwZS5yYW5kb21XYWxrID0gZnVuY3Rpb24gcmFuZG9tV2FsayhzdGVwcywgY2FyZGluYWwpIHtcbiAgdmFyIHBhdGggPSBbXTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGVwczsgaSsrKSB7XG4gICAgcGF0aC5wdXNoKHRoaXMucmFuZG9tRGlyZWN0aW9uKGNhcmRpbmFsKSlcbiAgfVxuICByZXR1cm4gcGF0aDtcbn07XG5cbldhbGsucHJvdG90eXBlLmRydW5rYXJkV2FsayA9IGZ1bmN0aW9uIGRydW5rYXJkV2FsayhzdGFydCwgc3RlcHMsIGNhcmRpbmFsKSB7XG4gIHZhciBwYXRoID0gW107XG4gIHZhciBjdXJyZW50U3RlcCA9IHN0YXJ0O1xuICB2YXIgbmV4dFN0ZXA7XG4gIHZhciBwb3NzaWJsZVN0ZXBzID0gdGhpcy5wb3NzaWJsZVN0ZXBzKGNhcmRpbmFsKTtcblxuICAvL0xvb3AgZm9yIG4gc3RlcHNcbiAgd2hpbGUgKHN0ZXBzID4gMCkge1xuICAgIC8vR2V0IGEgcmFuZG9tIHNodWZmbGVkIGFycmF5IG9mIGFsbCBwb3NzaWJsZSBzdGVwc1xuICAgIHZhciBuZXh0U3RlcExpc3QgPSByYW5kb20uc2h1ZmZsZUFycmF5KHBvc3NpYmxlU3RlcHMpLnNsaWNlKCk7XG4gICAgLy9BdHRlbXB0IGVhY2ggc3RlcCBpbiBhcnJheVxuICAgIHdoaWxlIChuZXh0U3RlcExpc3QubGVuZ3RoID4gMCkge1xuICAgICAgbmV4dFN0ZXAgPSBuZXh0U3RlcExpc3QucG9wKCk7XG4gICAgICB2YXIgYXR0ZW1wdGVkU3RlcCA9IFtjdXJyZW50U3RlcFswXSArIG5leHRTdGVwWzBdLCBjdXJyZW50U3RlcFsxXSArIG5leHRTdGVwWzFdXTtcbiAgICAgIC8vaWYgc3RlcCBoYXMgbm90IGJlZW4gdGFrZW4gdGhlbiB0YWtlIHRoZSBzdGVwXG4gICAgICBpZiAoIXRoaXMuc3RlcEluUGF0aChhdHRlbXB0ZWRTdGVwLCBwYXRoKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgLy9ObyBtb3JlIHN0ZXBzIHBvc3NpYmxlXG4gICAgaWYgKG5leHRTdGVwTGlzdC5sZW5ndGggPT0gMCkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgY3VycmVudFN0ZXAgPSBbY3VycmVudFN0ZXBbMF0gKyBuZXh0U3RlcFswXSwgY3VycmVudFN0ZXBbMV0gKyBuZXh0U3RlcFsxXV07XG4gICAgICBjb25zb2xlLmxvZyhjdXJyZW50U3RlcCk7XG4gICAgICBwYXRoLnB1c2goY3VycmVudFN0ZXApO1xuICAgICAgc3RlcHMtLTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhdGg7XG59O1xuV2Fsay5wcm90b3R5cGUuc3RlcEluUGF0aCA9IGZ1bmN0aW9uIHN0ZXBJblBhdGgoc3RlcCwgcGF0aCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHBhdGgubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoc3RlcFswXSA9PSBwYXRoW2ldWzBdICYmIHN0ZXBbMV0gPT0gcGF0aFsxXSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5XYWxrLnByb3RvdHlwZS5wb3NzaWJsZVN0ZXBzID0gZnVuY3Rpb24gcG9zc2libGVTdGVwcyhjYXJkaW5hbCkge1xuICBpZiAoY2FyZGluYWwpIHtcbiAgICByZXR1cm4gW1swLCAxXSwgWzEsIDBdLCBbMCwgLTFdLCBbLTEsIDBdXTtcbiAgfVxuICBlbHNlIHtcbiAgICByZXR1cm4gW1swLCAxXSwgWzEsIDFdLCBbMSwgMF0sIFsxLCAtMV0sIFswLCAtMV0sIFstMSwgLTFdLCBbLTEsIDBdLCBbLTEsIDFdXTtcbiAgfVxufTtcbldhbGsucHJvdG90eXBlLnJhbmRvbURpcmVjdGlvbiA9IGZ1bmN0aW9uIHJhbmRvbURpcmVjdGlvbihjYXJkaW5hbCkge1xuICB2YXIgZGlyZWN0aW9uID0gMDtcbiAgaWYgKGNhcmRpbmFsKSB7XG4gICAgZGlyZWN0aW9uID0gcmFuZG9tLmdldFJhbmRvbUludCgwLCAzKTtcbiAgICBzd2l0Y2ggKGRpcmVjdGlvbikge1xuICAgICAgY2FzZSAwOlxuICAgICAgICByZXR1cm4gWzAsIDFdO1xuICAgICAgY2FzZSAxOlxuICAgICAgICByZXR1cm4gWzEsIDBdO1xuICAgICAgY2FzZSAyOlxuICAgICAgICByZXR1cm4gWzAsIC0xXTtcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgcmV0dXJuIFstMSwgMF07XG4gICAgfVxuICB9XG4gIGVsc2Uge1xuICAgIGRpcmVjdGlvbiA9IHJhbmRvbS5nZXRSYW5kb21JbnQoMCwgNyk7XG4gICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgcmV0dXJuIFswLCAxXTtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgcmV0dXJuIFsxLCAxXTtcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgcmV0dXJuIFsxLCAwXTtcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgcmV0dXJuIFsxLCAtMV07XG4gICAgICBjYXNlIDQ6XG4gICAgICAgIHJldHVybiBbMCwgLTFdO1xuICAgICAgY2FzZSA1OlxuICAgICAgICByZXR1cm4gWy0xLCAtMV07XG4gICAgICBjYXNlIDY6XG4gICAgICAgIHJldHVybiBbLTEsIDBdO1xuICAgICAgY2FzZSA3OlxuICAgICAgICByZXR1cm4gWy0xLCAxXTtcbiAgICB9XG4gIH1cbn07XG5tb2R1bGUuZXhwb3J0cyA9IFdhbGs7IiwidmFyIFV0aWxzID0ge1xuICAgIGNvbnRhaW5zT2JqZWN0OiBmdW5jdGlvbihvYmosIGxpc3QpIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
